{% extends "base.html" %}
{% block content %}
<h2>管理者編集</h2>

<form method="post">
  {% if get_csrf %}<input type="hidden" name="csrf_token" value="{{ get_csrf() }}">{% endif %}
  
  <div class="form-group">
    <label for="login_id">ログインID</label>
    <input type="text" id="login_id" name="login_id" value="{{ admin.login_id }}" required>
  </div>
  
  <div class="form-group">
    <label for="name">氏名</label>
    <input type="text" id="name" name="name" value="{{ admin.name }}" required>
  </div>
  
  <div class="form-group">
    <label for="email">メールアドレス</label>
    <input type="email" id="email" name="email" value="{{ admin.email or '' }}" placeholder="例）admin@example.com">
  </div>
  
  <div class="form-group">
    <label for="password">パスワード（変更する場合のみ入力）</label>
    <input type="password" id="password" name="password" placeholder="変更しない場合は空欄">
  </div>
  
  <div class="form-group">
    <label for="password_confirm">パスワード（確認）</label>
    <input type="password" id="password_confirm" name="password_confirm" placeholder="もう一度入力">
  </div>
  
  {% if admin.is_owner == 1 %}
  <div class="form-group">
    <p style="color:#ff6f00;font-weight:bold">★ オーナー権限あり</p>
    <small style="color:#666">オーナー権限の移譲は一覧画面から行ってください。</small>
  </div>
  {% endif %}
  
  <div class="form-group">
    <label for="stores">管理する店舗 <span style="color:red">*</span></label>
    {% if stores %}
    <table style="border-collapse:collapse;width:100%">
      {% for store in stores %}
      <tr>
        <td style="border:1px solid #ccc;padding:8px;width:40px;text-align:center">
          <input type="checkbox" name="store_ids" value="{{ store.id }}" {% if store.id in admin_store_ids %}checked{% endif %}>
        </td>
        <td style="border:1px solid #ccc;padding:8px">{{ store['名称'] }}</td>
      </tr>
      {% endfor %}
    </table>
    {% else %}
      <p style="color:#999;margin:0">店舗が登録されていません。</p>
    {% endif %}
    <small style="color:#666">少なくとも1つの店舗を選択してください。</small>
  </div>
  
  <div class="form-group">
    <label for="active">有効/無効</label>
    {% if admin.is_owner == 1 %}
    <select id="active" name="active" disabled>
      <option value="1" selected>有効</option>
    </select>
    <input type="hidden" name="active" value="1">
    <small style="color:#666">※ オーナーは無効にできません</small>
    {% else %}
    <select id="active" name="active">
      <option value="1" {% if admin.active == 1 %}selected{% endif %}>有効</option>
      <option value="0" {% if admin.active == 0 %}selected{% endif %}>無効</option>
    </select>
    {% endif %}
  </div>
  
  <div class="actions">
    <button type="submit" class="btn">更新</button>
    <a href="{{ url_for('tenant_admin.admins') }}" class="btn sub">キャンセル</a>
  </div>
</form>
{% endblock %}
