{% extends "base.html" %}
{% block title %}テナント別アプリ設定{% endblock %}
{% block content %}
<h1>テナント別アプリ設定</h1>

<div class="card" style="max-width:800px">
  <h2>テナント選択</h2>
  <form method="POST" action="{{ url_for('system_admin.app_management_tenant') }}">
    <input type="hidden" name="action" value="select_tenant">
    
    <div style="margin-bottom:15px">
      <label for="tenant_id" style="display:block; margin-bottom:5px">テナント <span style="color:red">*</span></label>
      <select id="tenant_id" name="tenant_id" required style="width:100%; padding:8px; border:1px solid #ddd; border-radius:3px">
        <option value="">-- テナントを選択 --</option>
        {% for tenant in tenants %}
        <option value="{{ tenant.id }}" {% if selected_tenant_id == tenant.id %}selected{% endif %}>
          {{ tenant.name }}
        </option>
        {% endfor %}
      </select>
    </div>
    
    <button type="submit" class="btn">テナントを選択</button>
  </form>
</div>

{% if selected_tenant_id and tenant_apps %}
<div class="card" style="max-width:800px; margin-top:20px">
  <h2>アプリ設定</h2>
  <form method="POST" action="{{ url_for('system_admin.app_management_tenant') }}">
    <input type="hidden" name="action" value="update_apps">
    <input type="hidden" name="tenant_id" value="{{ selected_tenant_id }}">
    
    <table style="width:100%; border-collapse:collapse">
      <thead>
        <tr style="border-bottom:2px solid #ddd">
          <th style="text-align:left; padding:10px">アプリ名</th>
          <th style="text-align:center; padding:10px; width:120px">使用可否</th>
        </tr>
      </thead>
      <tbody>
        {% for app in tenant_apps %}
        <tr style="border-bottom:1px solid #eee">
          <td style="padding:10px">{{ app.display_name }}</td>
          <td style="text-align:center; padding:10px">
            <label style="display:inline-flex; align-items:center; cursor:pointer">
              <input type="checkbox" name="app_{{ app.name }}" {% if app.enabled %}checked{% endif %} style="margin-right:5px">
              <span>有効</span>
            </label>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    
    <button type="submit" class="btn" style="margin-top:20px">設定を保存</button>
  </form>
</div>
{% endif %}

<a href="{{ url_for('system_admin.app_management') }}" class="btn" style="margin-top:20px">アプリ管理に戻る</a>
{% endblock %}
