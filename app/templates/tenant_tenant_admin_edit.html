{% extends "base.html" %}
{% block content %}
<h2>テナント管理者編集</h2>

<form method="post">
  {% if get_csrf %}<input type="hidden" name="csrf_token" value="{{ get_csrf() }}">{% endif %}
  
  <div class="form-group">
    <label for="login_id">ログインID</label>
    <input type="text" id="login_id" name="login_id" value="{{ tadmin.login_id }}" required>
  </div>
  
  <div class="form-group">
    <label for="name">氏名</label>
    <input type="text" id="name" name="name" value="{{ tadmin.name }}" required>
  </div>
  
  <div class="form-group">
    <label for="email">メールアドレス</label>
    <input type="email" id="email" name="email" value="{{ tadmin.email or '' }}" placeholder="例: admin@example.com">
  </div>
  
  <div class="form-group">
    <label for="password">パスワード（変更する場合のみ入力）</label>
    <input type="password" id="password" name="password" placeholder="変更しない場合は空欄">
  </div>
  
  <div class="form-group">
    <label for="password_confirm">パスワード（確認）</label>
    <input type="password" id="password_confirm" name="password_confirm" placeholder="もう一度入力">
  </div>
  
  {% if tadmin.is_owner == 1 %}
  <div class="form-group">
    <p style="color:#ff6f00;font-weight:bold">★ オーナー権限あり</p>
    <small style="color:#666">オーナー権限の移譲は一覧画面から行ってください。</small>
  </div>
  {% endif %}
  
  {% if session.get('role') == 'system_admin' %}
  <div class="form-group">
    <label for="tenants">管理するテナント <span style="color:red">*</span></label>
    {% if tenants %}
      <table style="border-collapse:collapse;width:100%">
        {% for tenant in tenants %}
        <tr>
          <td style="border:1px solid #ccc;padding:8px;text-align:center;width:40px">
            <input type="checkbox" name="tenant_ids" value="{{ tenant.id }}" {% if tenant.id in tadmin_tenant_ids %}checked{% endif %}>
          </td>
          <td style="border:1px solid #ccc;padding:8px">{{ tenant.name }}</td>
        </tr>
        {% endfor %}
      </table>
    {% else %}
      <p style="color:#999;margin:0">テナントが登録されていません。</p>
    {% endif %}
    <small style="color:#666">少なくとも1つのテナントを選択してください。</small>
  </div>
  {% endif %}
  
  <div class="form-group">
    <label for="active">有効/無効</label>
    {% if tadmin.is_owner == 1 %}
    <select id="active" name="active" disabled>
      <option value="1" selected>有効</option>
    </select>
    <input type="hidden" name="active" value="1">
    <small style="color:#666">※ オーナーは無効にできません</small>
    {% else %}
    <select id="active" name="active">
      <option value="1" {% if tadmin.active == 1 %}selected{% endif %}>有効</option>
      <option value="0" {% if tadmin.active == 0 %}selected{% endif %}>無効</option>
    </select>
    {% endif %}
  </div>
  
  <div class="actions">
    <button type="submit" class="btn">更新</button>
    <a href="{{ url_for('tenant_admin.tenant_admins') }}" class="btn sub">キャンセル</a>
  </div>
</form>
{% endblock %}
